--source include/have_rocksdb.inc

--disable_warnings
DROP TABLE IF EXISTS t1, t2;
--enable_warnings

CREATE TABLE t1 (b INT PRIMARY KEY);
# Try simple foreign key - should succeed as it is being supported in myrocks
CREATE TABLE t2 (a INT NOT NULL, b INT NOT NULL, CONSTRAINT HAHA FOREIGN KEY (b) REFERENCES t1(b));
INSERT INTO t1 (b) VALUES (100),(200),(300);
INSERT INTO t2 (a,b) VALUES (1,100),(2,200),(3,300);

# Insert a row in the foreign table which does not have parent row should fail
--error ER_NO_REFERENCED_ROW_2
INSERT INTO t2 (a,b) VALUES (4,400);
# Drop foreign key in table 2 
ALTER TABLE t2 DROP FOREIGN KEY HAHA;
INSERT INTO t2 (a,b) VALUES (4,400);

DROP TABLE t2;
DROP TABLE t1;
